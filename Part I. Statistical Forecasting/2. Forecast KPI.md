<img width="2752" height="1536" alt="kpi_forecast" src="https://github.com/user-attachments/assets/84cebe3f-3cea-4ed4-860c-a75be088dbbb" />

# 2.1. Forecast Error:  
**Khái niệm:** Sai số dự báo (Forecast Error) là chỉ số giúp định lượng mức độ chính xác hay hiệu quả của một mô hình dự báo.
**Đặc điểm:** không có một chỉ số sai lệch dự báo nào phù hợp áp dụng cho tất cả mô hình. Chỉ có thể thực hiện kiểm tra và đánh giá xem KPI (Key Performance Indicator) nào sẽ  phù hợp với mô hình và bối cảnh thực tế vận hành
**Phân biệt Độ chính xác (Accuracy) và Độ lệch (Bias):**
 
|                | Độ chính xác (Accuracy)                                                                                              | Độ lệch (Bias)                                                                                                       |
| -------------- | -------------------------------------------------------------------------------------------------------------------- | -------------------------------------------------------------------------------------------------------------------- |
| **Định nghĩa** | Đo lường mức độ phân tán (spread) giữa các giá trị dự báo và giá trị thực tế                                         | Đo lường hướng sai lệch trung bình của dự báo                                                                        |
| **Ý nghĩa**    | Nó cho biết **độ lớn** của sai số (bạn sai bao nhiêu?), nhưng không cho biết hướng của sai số (cao hơn hay thấp hơn) | Nó trả lời câu hỏi: Dự báo trung bình là quá cao (**overshot**) hay quá thấp (**undershot**) so với nhu cầu thực tế? |
**Mục tiêu:** Một dự báo tốt cần phải đạt cả hai yếu tố: vừa chính xác (sai số nhỏ) vừa không bị chệch (nhắm đúng mục tiêu)
<img width="481" height="362" alt="accuracyvsbias" src="https://github.com/user-attachments/assets/9e12abd6-5f5f-49da-92e8-23f89bc9f2fc" />

**Công thức:**

$$ e_t = f_t - d_t $$

e_t: độ chính xác của dự báo ở mốc thời gian t
f_t: dự báo của mốc thời gian t
d_t: nhu cầu của mốc thời gian t
# 2.2. MAPE:
**Khái niệm:** MAPE (Mean Absolute Percentage Error) là một trong các chỉ số phổ biến để đo lường mức độ chính xác của dự báo. MAPE là phép tính trung bình cộng từng sai số tuyệt đối chia cho nhu cầu thực tế. Nói ngắn gọn, MAPE là giá trị trung bình của phần trầm các sai số tuyệt đối

**Công thức:**

$$ MAPE = \frac{1}{n} \sum_{n} \frac{|e_t|}{d_t} $$

**Đánh giá:**

| Ưu điểm              | Nhược điểm                                                                                                                                                        |
| -------------------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| Đơn giản và phổ biến | **Bị lệch (Skewed):** MAPE chia sai số cho nhu cầu thực tế (dt​). Nếu nhu cầu thực tế rất nhỏ, kết quả phần trăm sai số sẽ cực kỳ lớn, làm méo mó chỉ số tổng thể |
|                      | MAPE thường dẫn đến **dự báo thấp hơn thực tế (undershoot)** để tránh các sai số phần trăm lớn                                                                    |
**Ghi chú:** Mặc dù MAPE là một KPI đơn giản và phổ biến trong bối cảnh quản trị kinh doanh nhưng MAPE lại là một KPI tồi. Lời khuyên đưa ra là không nên sử dụng MAPE làm chỉ số đo lường mức độ hiệu quả của mô hình dự báo
# 2.3. MAE:
**Khái niệm:** MAE (Mean Absolute Error) là trung bình sai số tuyệt đối của mô hình. **MAE là chỉ số tốt để đo lường mức độ hiệu của của mô hình dự báo**
**Ghi chú:** Vì MAE là một số tuyệt đối nên khi không có ngữ cảnh so sánh với nhu cầu trung bình (Average demand) chúng ta khó xác định được con số này là tốt hay tệ. Do đó, thông thường MAE sẽ được chuẩn hóa về đơn vị phần trăm (%) bằng cách chi cho trung bình nhu cầu thực tế để thực hiện đánh giá đo lường
**Công thức:**

$$ MAE = \frac{1}{n} \sum_{n} |e_t| $$

$$ MAE(perc) = \frac{\frac{1}{n} \sum |e_t|}{\frac{1}{n} \sum d_t} = \frac{\sum |e_t|}{\sum d_t} $$

**Đánh giá:**

| Ưu điểm                                                                                                                                                                                                                          | Nhược điểm                                                                                                                                                                                                                              |
| -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **Ổn định với yếu tố ngoại lai (Robust to outliers):** MAE không bình phương sai số như RMSE, nên nó ít bị ảnh hưởng bởi một vài sai số cực lớn. Nếu dữ liệu của bạn có nhiều nhiễu động bất thường, MAE giúp dự báo ổn định hơn | **Gây ra độ chệch (Bias):** Nếu phân phối nhu cầu bị lệch (ví dụ: thỉnh thoảng có đơn hàng lớn), trung vị sẽ thấp hơn trung bình. Do đó, dự báo theo MAE thường bị thấp hơn thực tế (undershoot)                                        |
| **Hướng về trung vị (Median):** Về mặt toán học, tối ưu hóa MAE sẽ hướng dự báo về giá trị **trung vị** của nhu cầu                                                                                                              | **Kém hiệu quả với nhu cầu ngắt quãng (Intermittent demand):** Với các sản phẩm bán chậm (ví dụ: bán 0 trong nhiều tuần), trung vị thường là 0. Dùng MAE sẽ dẫn đến dự báo bằng 0, điều này không hữu ích cho việc lập kế hoạch tồn kho |

# 2.4. RMSE:
**Khái niệm:** RMSE (Root Mean Square Error) là Căn bậc hai của Trung bình bình phương sai số. RMSE là một chỉ số khá phổ biến. Cũng giống như MAE, RMSE cũng là một số tuyệt đối và thường được chuẩn hóa bằng cách chia cho trung bình nhu cầu thực thế (Average demand)
**Công thức:**

$$ RMSE = \sqrt{\frac{1}{n} \sum_{n} e_t^2} $$

$$ RMSE (perc) = \frac{\sqrt{\frac{1}{n} \sum_{n} e_t^2}}{\frac{1}{n} \sum_{n} d_t} $$

**Đánh giá:**

| Ưu điểm                                                                                                                                                                                                                                            | Nhược điểm                                                                                                                                                       |
| -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **Gán trọng số lỗi lớn (Weighting of errors):** Do sai số được bình phương trước khi tính trung bình, RMSE gán trọng số lớn hơn cho các sai số lớn. Một sai số rất lớn duy nhất có thể làm tăng RMSE đáng kể, trong khi MAE sẽ ít bị ảnh hưởng hơn | Rất nhạy cảm với các giá trị ngoại lai (outliers). Nếu dữ liệu có một đợt bán hàng đột biến bất thường, RMSE sẽ tăng vọt, có thể khiến mô hình phản ứng thái quá |
| **Hướng về Trung bình (Average):** Về mặt toán học, việc tối ưu hóa RMSE sẽ hướng dự báo về giá trị **trung bình (mean)** của nhu cầu. Điều này giúp dự báo không bị chệch (unbiased)                                                              |                                                                                                                                                                  |

# 2.5. Nên chọn Forecast KPI nào?

**2.5.1. Trung vị  (Median) hay Trung bình (Mean)?**
- **MAE:** Khi tối ưu hóa mô hình theo MAE, đồng nghĩa đang hướng dự báo về giá trị **trung vị (median)** của nhu cầu. MAE cố gắng cân bằng số lần dự báo cao hơn và thấp hơn thực tế (overshoots = undershoots).
- **RMSE:** Khi tối ưu hóa theo RMSE, tức là đang hướng dự báo về giá trị **trung bình (mean)** của nhu cầu. RMSE hướng tới việc tổng dự báo bằng tổng nhu cầu thực tế
2.5.2. So sánh dựa trên 3 yếu tố:
Khi thực hiện đánh giá KPI nào sẽ phù hợp cho mô hình và đặc điểm kinh tế của mô hình, thường dựa trên 3 yếu tố: 
1. Độ lệch (Bias)
2. Độ nhạy với ngoại lai (Outliers sensitivity)
3. Nhu cầu đứt quãng (Intermittent demand)

|                                              | Đặc điểm                                                                                                                                                | MAE                                                                                                    | RMSE                                                                                                                                                                                                          | Kết luận                                                                                           |
| -------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------ | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | -------------------------------------------------------------------------------------------------- |
| Độ lệch (Bias)                               | Nhiều sản phẩm có phân phối nhu cầu bị lệch (ví dụ: thỉnh thoảng có đơn hàng lớn đột biến). Khi đó, giá trị trung vị thường thấp hơn giá trị trung bình | Vì nhắm vào trung vị, MAE sẽ tạo ra dự báo thấp hơn trung bình thực tế, gây ra độ chệch âm (undershot) | Nhắm vào trung bình nên sẽ tạo ra dự báo không bị chệch (unbiased)                                                                                                                                            | Nếu muốn tránh Bias, hãy dùng **RMSE**                                                             |
| Độ nhạy với ngoại lai (Outliers sensitivity) | Những nhu cầu **cao hoặc thấp bất thường**. Có thể gây ra rủi ro khiến mô hình dự báo phản ứng thái quá, dẫn đến việc đặt hàng tồn kho sai lệch (thừa hoặc thiếu) và gây ra hiệu ứng bullwhip                                                                                                                                                        | Bền vững hơn (robust) trước các giá trị ngoại lai vì nó không bình phương sai số                       | Do bình phương sai số (e2), RMSE trừng phạt rất nặng các lỗi lớn. Một vài giá trị ngoại lai (outliers) có thể đẩy RMSE lên rất cao, khiến mô hình phản ứng thái quá để cố gắng dự báo đúng các điểm nhiễu này | Nếu dữ liệu có nhiều nhiễu động bất thường mà muốn làm mượt (bỏ qua), **MAE** là lựa chọn tốt hơn. |
| Nhu cầu đứt quãng (Intermittent demand)      | Với các sản phẩm bán chậm (ví dụ: bán 0 trong nhiều tuần liên tiếp), trung vị của nhu cầu thường là 0                                                   | Sẽ dẫn đến dự báo bằng 0 (vì tối ưu theo trung vị), điều này vô dụng cho việc lập kế hoạch             | Sẽ vẫn cố gắng dự báo mức trung bình (ví dụ: 0.3 cái/tuần), giúp bạn có con số để tính toán tồn kho                                                                                                           | Tránh dùng MAE cho nhu cầu ngắt quãng; hãy dùng **RMSE**.                                          |

### Tài liệu tham khảo
**Data Science for Supply Chain Forecasting (2nd edition)**: Nicolas Vandeput (2021)
