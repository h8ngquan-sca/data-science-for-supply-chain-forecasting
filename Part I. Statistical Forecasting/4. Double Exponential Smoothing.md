<img width="2752" height="1536" alt="DES" src="https://github.com/user-attachments/assets/a40600be-9a9e-41de-900a-9e2f1d1c8e63" />

# 4.1. Giới thiệu tổng quan

**Ý tưởng cốt lõi**
Mô hình **San bằng hàm mũ kéo -** **Double Exponential Smoothing (DES)** là phiên bản nâng cấp (bổ sung) của mô hình Exponential Smoothing (ES) đơn giản. Mô hình DES có khả năng xác định yếu tố Xu hướng (Trend).

**Khái niệm Xu hướng (Trend)**
**Xu hướng (Trend)** là mức độ biến thiên trung bình của Mức độ (Level) trong chuỗi thời gian (Time Series) giữa hai kỳ liên tiếp

**Kết quả đầu ra**
Mô hình DES sẽ ước lượng Xu hướng dựa trên trọng số mũ ***beta (β)***, gán mức độ quan trọng nhiều hơn (hoặc ít hơn) cho các quan sát gần nhất.
Kết quả, đường dự báo sẽ có độ dốc (thể hiện đà tăng/giảm) thay vì chỉ đi ngang.
# 4.2. Cách mô hình hoạt động
## 4.2.1. Công thức

**Công thức Level**

$$a_t = αd_t + (1-α)(a_{t-1})(b_{t-1})$$

**Công thức Trend**

$$b_t = β(a_t - a_{t-1}) + (1-β)b_{t-1}$$

**Công thức Forecast**

$$Forecast = Level + Trend$$

$$f_{t+λ} = a_t + λb_t$$

## 4.2.2. Dự báo tương lai - Future Forecast
Mô hình San bằng hàm mũ kép (Double Exponential Smoothing) khi vượt ra khỏi vùng dữ liệu lịch sử thì:
- **Xu hướng (Trend):** Giữ nguyên không đổi (stay constant). Mô hình sẽ lấy giá trị xu hướng ở kỳ thực tế cuối cùng và áp dụng cho toàn bộ tương lai.
- **Mức độ (Level) & Dự báo:** Trở nên tương đương nhau. 

**Kết luận**: Dự báo cho kỳ tương lai chỉ đơn giản là lấy "Mức độ" hiện tại cộng dồn liên tục với "Xu hướng".

**Rủi ro lớn nhất:** Mô hình này sẽ giả định xu hướng cuối cùng **kéo dài mãi mãi** (tăng lên vô tận hoặc giảm xuống vô tận). Điều này cực kỳ rủi ro cho các dự báo trung và dài hạn, và phải dùng một biến thể khác là Double Exponentital Smoothing with Damped Trend (chương tiếp theo) để khắc phục.
## 4.2.3. Khởi tạo mô hình - Model Inititalization

**Khởi tạo đơn giản - Simple Initialization**
- **Level ($a_0$):** Được khởi tạo bằng chính nhu cầu của kỳ đầu tiên ($a_0 = d_0$).
- **Trend ($b_0$):** Được khởi tạo bằng chênh lệch nhu cầu giữa kỳ thứ hai và kỳ đầu tiên ($b_0 = d_1 - d_0$).
_Nhược điểm:_ Phương pháp này có thể dẫn đến hiện tượng quá khớp (overfitting) do được cung cấp trước một phần thông tin của tương lai (nhu cầu kỳ 1) để khởi tạo cho kỳ 0.

**Hồi quy tuyến tính - Linear Regression**
- Sử dụng hồi quy tuyến tính trên $n$ kỳ nhu cầu đầu tiên để khởi tạo giá trị $a_0$ và $b_0$. Có thể chọn $n$ là một số nhỏ (3 hoặc 5) hoặc bằng nghịch đảo trung bình của hệ số học tập $\alpha$ và $\beta$.
_Lưu ý:_ Phương pháp này cũng tiềm ẩn rủi ro rò rỉ dữ liệu (data leakage) nếu bạn sử dụng quá nhiều dữ liệu tương lai để tính toán hồi quy.

| Phương pháp                                  | Cách tính / Công thức                                                                                | Đánh giá & Lưu ý                                                                                                                                                                                                                                                                                                                                      |
| :------------------------------------------- | :--------------------------------------------------------------------------------------------------- | :---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **Khởi tạo đơn giản(Simple Initialization)** | - **Mức độ:** $a_0 = d_0$<br>- **Xu hướng:** $b_0 = d_1 - d_0$.                                      | - **Ưu điểm:** Đơn giản, công bằng và ít rủi ro rò rỉ dữ liệu.<br>- **Nhược điểm:** Dự báo kỳ tiếp theo ($f_1$) sẽ chính xác tuyệt đối 100%, điều này có thể mang lại lợi thế không công bằng và gây hiện tượng "quá khớp" (overfitting) trên tập dữ liệu nhỏ.<br>- **Cách khắc phục:** Nên loại bỏ kỳ dự báo đầu tiên ra khỏi bước tính toán sai số. |
| **Hồi quy tuyến tính(Linear Regression)**    | Sử dụng hồi quy tuyến tính trên $n$ kỳ nhu cầu lịch sử đầu tiên để ước lượng giá trị $a_0$ và $b_0$. | - **Thiết lập:** Có thể chọn $n$ là một số nhỏ (3 hoặc 5), hoặc tỷ lệ với trung bình nghịch đảo của $\alpha$ và $\beta$.<br>- **Rủi ro:** Khi giá trị $n$ càng lớn, rủi ro vướng vào bẫy "rò rỉ dữ liệu" (data leakage) càng cao do bạn đã dùng quá nhiều dữ liệu tương lai để khởi tạo.                                                              |
# 4.3. Đánh giá và Kết luận
## 4.3.1. Mối quan hệ giữ Xu hướng (Trend) và Lỗi dự báo (Error)

<img width="631" height="276" alt="5 2" src="https://github.com/user-attachments/assets/f4a4b9de-67c4-4ca3-a6b0-efae8f1c12d1" />

Nhìn vào hình 5.2 có thể thấy, Xu hướng (Trend) giảm khi Lỗi dự báo (Error) dương (positive). Ngược lại, khi Xu hướng tăng khi Lỗi dự báo âm (negative)
- Trend giảm - Error (+)
- Trend tăng - Error (-)

Mối quan hệ giữa **Xu hướng (Trend)** và **Sai số (Error)** thể hiện một đặc điểm rất thông minh của mô hình, đó là khả năng tự "học" từ những sai lầm của chính nó:
- Nếu dự báo kỳ trước của mô hình cao hơn nhu cầu thực tế (sai số dương/overshot), nó sẽ tự động **giảm** xu hướng xuống.
- Ngược lại, nếu dự báo thấp hơn thực tế (sai số âm/undershot), nó sẽ **tăng** xu hướng lên để bù đắp.
Nhờ cơ chế này, mô hình liên tục tự điều chỉnh đường xu hướng để bám sát nhất với thay đổi của nhu cầu

Tuy nhiên, việc muốn mô hình "học nhanh hơn" bằng cách đẩy các hệ số α và β lên quá cao lại tiềm ẩn một rủi ro rất lớn.

<img width="567" height="272" alt="5 3" src="https://github.com/user-attachments/assets/7d1a823d-f5db-4352-8869-aff4a08ce16d" />

Nhìn vào hình 5.3, khi đặt cho α và β ở mức quá cao (ví dụ: 0.8), đường dự báo cho các kỳ tương lai xa (như t+5) sẽ bắt đầu **dao động dữ dội** (lên xuống liên tục) quanh mức nhu cầu thực tế.
Trong quản lý chuỗi cung ứng, điều này cực kỳ nguy hiểm vì những dự báo sai lệch liên tục này sẽ dễ tạo ra **hiệu ứng cái roi da (bullwhip effect)** - nơi những biến động nhỏ ở nhu cầu khách hàng bị khuếch đại thành những biến động khổng lồ ở đầu chuỗi cung ứng. ***Do đó, tài liệu khuyên không nên đặt các hệ số này vượt quá mức 0.6***
	
***Bullwhip effect** hay còn gọi là Hiệu ứng roi da là hiện tượng những biến động nhỏ trong nhu cầu ở hạ nguồn (downstream) dẫn đến biến động lớn cho chuỗi cung ứng thượng nguồn (upstream)*

## 4.3.2. Cách mô hình nhìn nhận Nhu cầu (Demand)
Mô hình San bằng hàm mũ kép, thể hiện sự **minh bạch** thông qua hai yếu tố:

**1/ Bóc tách nhu cầu (Decomposition):** mô hình cho phép bạn nhìn thấu bên trong bằng cách chia nhỏ chuỗi thời gian thành các thành phần cụ thể: Mức độ (Level) và Xu hướng (Trend). Cho phép vẽ biểu đồ các thành phần này để hiểu chính xác lý do tại sao mô hình lại đưa ra một con số dự báo cụ thể.

<img width="601" height="253" alt="5 4" src="https://github.com/user-attachments/assets/45f044db-d5e8-4fc2-a478-85ad2823a558" />


**2/ Đọc vị sản phẩm qua tham số:** Giá trị của các hệ số làm mượt (như $\alpha$ và $\beta$) sẽ tiết lộ đặc tính của sản phẩm. Hệ số cao cho thấy sản phẩm có biến động lớn và mô hình phải phản ứng với mọi thay đổi ngắn hạn; hệ số thấp chứng tỏ sản phẩm có hành vi rất ổn định.

## 4.3.3. Những hạn chế của mô hình
1. **Giả định xu hướng kéo dài vô tận:** Đây là rủi ro nguy hiểm nhất. Mô hình mặc định rằng đà tăng (hoặc giảm) hiện tại sẽ tiếp diễn mãi mãi. Điều này khiến kết quả dự báo trong trung và dài hạn có thể dẫn đến những con số phi thực tế và sai lệch nặng nề.
2. **Không nhận diện được tính mùa vụ:** Dù bắt được xu hướng, mô hình vẫn hoàn toàn không có khả năng nhận biết các chu kỳ biến động lặp đi lặp lại theo mùa.
3. **Không tích hợp được yếu tố ngoại cảnh:** Mô hình vẫn không thể trực tiếp sử dụng các thông tin bên ngoài như ngân sách marketing, sự kiện khuyến mãi hay thay đổi giá cả để điều chỉnh dự báo.

| Nhược điểm                                                 | Mô tả                                                                                                                                       |
| :--------------------------------------------------------- | :------------------------------------------------------------------------------------------------------------------------------------------ |
| **Giả định xu hướng kéo dài vô tận** (Infinite trend)      | Mô hình mặc định rằng xu hướng hiện tại sẽ tiếp diễn mãi mãi, điều này dẫn đến rủi ro sai lệch rất lớn đối với các dự báo trung và dài hạn. |
| **Không nhận diện được tính mùa vụ** (Lack of seasonality) | Mô hình hoàn toàn không có khả năng nhận biết và dự báo các chu kỳ biến động lặp đi lặp lại theo mùa.                                       |
| **Bỏ qua các yếu tố ngoại cảnh** (No external information) | Mô hình không thể trực tiếp sử dụng các thông tin bên ngoài tác động đến nhu cầu như ngân sách marketing hay thay đổi giá cả.               |

Để giải quyết nhượcc điểm "xu hướng kéo dài vô tận" này, chúng ta cần sử dụng một mô hình nâng cấp tên là **Double Exponential Smoothing with Damped Trend** *(tìm hiểu ở chương tiếp theo)*

### Tài liệu tham khảo
**Data Science for Supply Chain Forecasting (2nd edition):** Nicolas Vandeput (2021)
